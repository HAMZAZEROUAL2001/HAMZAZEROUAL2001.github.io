<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Anti-VM Detection Techniques - Hamza Zeroual</title>
    <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon" />
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700,900" rel="stylesheet" />
    <link rel="stylesheet" href="../libs/font-awesome/css/font-awesome.min.css" />
    <link href="../css/bootstrap.min.css" rel="stylesheet" />
    <link href="../css/styles.css" rel="stylesheet" />
    <style>
        .project-detail { padding: 80px 15px 50px; min-height: 100vh; }
        .project-header { background: linear-gradient(135deg, #8e44ad 0%, #3498db 100%); color: white; padding: 60px 0; margin-bottom: 50px; }
        .project-header h1 { font-size: 2.5em; margin-bottom: 20px; font-weight: 300; }
        .project-meta { display: flex; gap: 20px; flex-wrap: wrap; margin-top: 20px; }
        .project-meta .badge { padding: 8px 15px; font-size: 14px; background: rgba(255,255,255,0.2); border-radius: 20px; }
        .back-button { display: inline-block; margin-bottom: 20px; padding: 10px 20px; background: rgba(255,255,255,0.2); color: white; text-decoration: none; border-radius: 4px; transition: background 0.3s; }
        .back-button:hover { background: rgba(255,255,255,0.3); color: white; text-decoration: none; }
        .project-content { max-width: 900px; margin: 0 auto; }
        .section-box { background: #f8f9fa; padding: 30px; margin-bottom: 30px; border-radius: 8px; border-left: 4px solid #8e44ad; }
        .section-box h2 { color: #374054; font-size: 1.8em; margin-bottom: 20px; font-weight: 300; }
        .section-box h3 { color: #374054; font-size: 1.4em; margin-top: 20px; margin-bottom: 15px; font-weight: 400; }
        .section-box ul { list-style: none; padding-left: 0; }
        .section-box ul li { margin-bottom: 10px; color: #74808a; }
        .section-box ul li:before { content: "âœ“ "; color: #2ecc71; font-weight: bold; margin-right: 10px; }
        .tech-stack { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 15px; }
        .tech-badge { background: #8e44ad; color: white; padding: 8px 15px; border-radius: 4px; font-size: 14px; }
        pre { background: #2c3e50; color: #ecf0f1; padding: 20px; border-radius: 4px; overflow-x: auto; }
        code { font-family: 'Courier New', monospace; }
        .github-link { display: inline-block; padding: 15px 30px; background: #374054; color: white; text-decoration: none; border-radius: 4px; font-size: 16px; margin-top: 20px; transition: background 0.3s; }
        .github-link:hover { background: #2c3e50; color: white; text-decoration: none; }
    </style>
</head>

<body>
    <div class="project-header">
        <div class="container">
            <a href="../index.html#projects" class="back-button">
                <i class="fa fa-arrow-left"></i> Back to Portfolio
            </a>
            <h1><i class="fa fa-laptop"></i> Anti-VM Detection Techniques</h1>
            <p style="font-size: 1.2em; opacity: 0.9;">Techniques to detect if code is running in a VM or host machine and identify hypervisor presence</p>
            
            <div class="project-meta">
                <span class="badge"><i class="fa fa-code"></i> C++</span>
                <span class="badge"><i class="fa fa-calendar"></i> 2024</span>
                <span class="badge"><i class="fa fa-tag"></i> Malware Analysis</span>
                <span class="badge"><i class="fa fa-star"></i> 1 Star</span>
            </div>
        </div>
    </div>

    <div class="project-detail">
        <div class="container">
            <div class="project-content">
                <!-- Overview Section -->
                <div class="section-box">
                    <h2><i class="fa fa-info-circle"></i> Project Overview</h2>
                    <p>
                        This project implements various techniques to detect if code is executing in a virtual machine environment 
                        versus a physical host machine. It's particularly useful for malware analysis evasion and understanding 
                        how sophisticated malware detects sandbox environments.
                    </p>
                    <p>
                        The tool can identify popular hypervisors (VMware, VirtualBox, Hyper-V, QEMU) using multiple detection 
                        methods including CPUID instructions, registry checks, file artifacts, and hardware fingerprinting.
                    </p>
                </div>

                <!-- Technologies Section -->
                <div class="section-box">
                    <h2><i class="fa fa-wrench"></i> Technologies & Tools</h2>
                    <div class="tech-stack">
                        <span class="tech-badge">C++</span>
                        <span class="tech-badge">Assembly (x86/x64)</span>
                        <span class="tech-badge">Windows API</span>
                        <span class="tech-badge">CPUID Instructions</span>
                        <span class="tech-badge">WMI</span>
                        <span class="tech-badge">Registry Analysis</span>
                    </div>
                </div>

                <!-- Detection Methods Section -->
                <div class="section-box">
                    <h2><i class="fa fa-search"></i> Detection Methods Implemented</h2>
                    
                    <h3>1. CPUID-Based Detection</h3>
                    <ul>
                        <li>Check hypervisor bit (CPUID leaf 0x1, ECX bit 31)</li>
                        <li>Query hypervisor vendor string (CPUID leaf 0x40000000)</li>
                        <li>Timing attacks using RDTSC instruction</li>
                    </ul>

                    <h3>2. Hardware Artifacts</h3>
                    <ul>
                        <li>MAC address checks (VMware: 00:0C:29, 00:50:56)</li>
                        <li>Hard disk serial numbers</li>
                        <li>BIOS/UEFI information</li>
                        <li>System manufacturer strings</li>
                    </ul>

                    <h3>3. Process & Driver Detection</h3>
                    <ul>
                        <li>VMware Tools processes (vmtoolsd.exe, vmwaretray.exe)</li>
                        <li>VirtualBox drivers (VBoxGuest, VBoxSF)</li>
                        <li>Hyper-V services (vmms.exe, vmcompute.exe)</li>
                    </ul>

                    <h3>4. Registry Keys</h3>
                    <ul>
                        <li>VMware registry entries</li>
                        <li>VirtualBox guest additions keys</li>
                        <li>Hyper-V integration services</li>
                    </ul>

                    <h3>5. File System Artifacts</h3>
                    <ul>
                        <li>VMware Tools installation paths</li>
                        <li>VirtualBox guest additions files</li>
                        <li>QEMU guest agent binaries</li>
                    </ul>
                </div>

                <!-- Technical Implementation Section -->
                <div class="section-box">
                    <h2><i class="fa fa-cogs"></i> Technical Implementation</h2>
                    
                    <h3>CPUID Hypervisor Detection</h3>
                    <pre><code>// Check if hypervisor present using CPUID
bool IsHypervisorPresent() {
    int cpuInfo[4];
    __cpuid(cpuInfo, 1);
    
    // Check bit 31 of ECX (hypervisor present bit)
    return (cpuInfo[2] >> 31) & 1;
}

// Get hypervisor vendor string
std::string GetHypervisorVendor() {
    int cpuInfo[4];
    char vendor[13] = {0};
    
    __cpuid(cpuInfo, 0x40000000);
    memcpy(vendor, &cpuInfo[1], 4);
    memcpy(vendor + 4, &cpuInfo[2], 4);
    memcpy(vendor + 8, &cpuInfo[3], 4);
    
    return std::string(vendor);
}</code></pre>

                    <h3>MAC Address Verification</h3>
                    <pre><code>// Check for VMware MAC address prefixes
bool IsVMwareMac(const char* mac) {
    return (strncmp(mac, "00:0C:29", 8) == 0 ||
            strncmp(mac, "00:50:56", 8) == 0 ||
            strncmp(mac, "00:1C:14", 8) == 0);
}</code></pre>
                </div>

                <!-- Results Section -->
                <div class="section-box">
                    <h2><i class="fa fa-bar-chart"></i> Detection Accuracy</h2>
                    <ul>
                        <li>VMware detection: 95%+ accuracy using multiple methods</li>
                        <li>VirtualBox detection: 90%+ accuracy</li>
                        <li>Hyper-V detection: 85%+ accuracy</li>
                        <li>QEMU/KVM detection: 80%+ accuracy</li>
                        <li>Low false positive rate on physical machines</li>
                    </ul>
                </div>

                <!-- Use Cases Section -->
                <div class="section-box">
                    <h2><i class="fa fa-lightbulb-o"></i> Use Cases</h2>
                    <ul>
                        <li><strong>Malware Analysis:</strong> Understand how malware evades sandbox analysis</li>
                        <li><strong>Security Research:</strong> Test detection bypass techniques</li>
                        <li><strong>Penetration Testing:</strong> Verify if target is running in VM</li>
                        <li><strong>Software Licensing:</strong> Prevent VM-based license abuse</li>
                        <li><strong>Forensics:</strong> Determine execution environment</li>
                    </ul>
                </div>

                <!-- Learning Outcomes Section -->
                <div class="section-box">
                    <h2><i class="fa fa-graduation-cap"></i> Learning Outcomes</h2>
                    <ul>
                        <li>Deep understanding of x86/x64 CPU instructions (CPUID, RDTSC)</li>
                        <li>Knowledge of hypervisor architecture and detection surfaces</li>
                        <li>Experience with low-level Windows programming</li>
                        <li>Understanding of malware evasion techniques</li>
                        <li>Skills in hardware and software fingerprinting</li>
                    </ul>
                </div>

                <!-- Links Section -->
                <div style="text-align: center; margin-top: 40px;">
                    <a href="https://github.com/HAMZAZEROUAL2001/anti-VM-technique" target="_blank" class="github-link">
                        <i class="fa fa-github"></i> View on GitHub
                    </a>
                </div>
            </div>
        </div>
    </div>

    <footer style="margin-top: 50px; padding: 20px 0; background: #f8f9fa;">
        <div class="container">
            <div class="row">
                <div class="col-sm-12 text-center">
                    <p style="color: #74808a;">&copy; 2025 Hamza Zeroual - Cybersecurity Portfolio</p>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
</body>
</html>
